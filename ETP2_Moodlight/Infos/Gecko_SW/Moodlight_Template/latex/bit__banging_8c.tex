\hypertarget{bit__banging_8c}{}\doxysection{bit\+\_\+banging.\+c File Reference}
\label{bit__banging_8c}\index{bit\_banging.c@{bit\_banging.c}}


bit-\/banging protocol for the W\+S2812 L\+ED integrated light source  


{\ttfamily \#include $<$stdint.\+h$>$}\newline
{\ttfamily \#include $<$stdbool.\+h$>$}\newline
{\ttfamily \#include \char`\"{}em\+\_\+device.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}em\+\_\+chip.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}em\+\_\+cmu.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}em\+\_\+gpio.\+h\char`\"{}}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{bit__banging_8c_ab0c169c959c5be67954c866776329563}\label{bit__banging_8c_ab0c169c959c5be67954c866776329563}} 
\#define \mbox{\hyperlink{bit__banging_8c_ab0c169c959c5be67954c866776329563}{D\+A\+T\+A\+\_\+\+P\+O\+RT}}~gpio\+PortD
\begin{DoxyCompactList}\small\item\em Port for serial data output. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{bit__banging_8c_adad67fe595ea440c8f8247ec2cddf070}\label{bit__banging_8c_adad67fe595ea440c8f8247ec2cddf070}} 
\#define \mbox{\hyperlink{bit__banging_8c_adad67fe595ea440c8f8247ec2cddf070}{D\+A\+T\+A\+\_\+\+P\+IN}}~0
\begin{DoxyCompactList}\small\item\em Pin for serial data output. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{bit__banging_8c_a4b6e515e6bd9995d85a203b8326fc49f}\label{bit__banging_8c_a4b6e515e6bd9995d85a203b8326fc49f}} 
\#define \mbox{\hyperlink{bit__banging_8c_a4b6e515e6bd9995d85a203b8326fc49f}{T\+R\+I\+G\+G\+E\+R\+\_\+\+P\+O\+RT}}~gpio\+PortD
\begin{DoxyCompactList}\small\item\em Port for oscilloscope trigger signal. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{bit__banging_8c_adacee581176b7076b7baf0f72d81460f}\label{bit__banging_8c_adacee581176b7076b7baf0f72d81460f}} 
\#define \mbox{\hyperlink{bit__banging_8c_adacee581176b7076b7baf0f72d81460f}{T\+R\+I\+G\+G\+E\+R\+\_\+\+P\+IN}}~1
\begin{DoxyCompactList}\small\item\em Pin for oscilloscope trigger signal. \end{DoxyCompactList}\item 
\mbox{\Hypertarget{bit__banging_8c_a6d20623550ae3618c35ef0e9cb8e9843}\label{bit__banging_8c_a6d20623550ae3618c35ef0e9cb8e9843}} 
\#define \mbox{\hyperlink{bit__banging_8c_a6d20623550ae3618c35ef0e9cb8e9843}{D\+A\+T\+A\+\_\+\+B\+Y\+T\+ES}}~4
\begin{DoxyCompactList}\small\item\em Number of data bytes to be transmitted. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{bit__banging_8c_a6722aa896fe7c90c4e283f433ea7985d}{I\+N\+I\+T\+\_\+\+X\+Oclocks}} ()
\begin{DoxyCompactList}\small\item\em Start crystal oscillators and use these clock sources. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{bit__banging_8c_a825a38d3f87d03f011520ff66261fe74}{G\+P\+I\+O\+\_\+\+Init}} ()
\begin{DoxyCompactList}\small\item\em Configure the G\+P\+I\+Os used for data and trigger. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{bit__banging_8c_a837aa058320a106868b138d6a23b5e44}{D\+A\+T\+A\+\_\+out}} (uint8\+\_\+t \mbox{\hyperlink{bit__banging_8c_ace95c61f334660f258cfa1ec48b46932}{data}}\mbox{[}$\,$\mbox{]}, uint32\+\_\+t length)
\begin{DoxyCompactList}\small\item\em Output the data using bit-\/banging technique. \end{DoxyCompactList}\item 
int \mbox{\hyperlink{bit__banging_8c_a840291bc02cba5474a4cb46a9b9566fe}{main}} (void)
\begin{DoxyCompactList}\small\item\em Main function. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{bit__banging_8c_ace95c61f334660f258cfa1ec48b46932}\label{bit__banging_8c_ace95c61f334660f258cfa1ec48b46932}} 
uint8\+\_\+t \mbox{\hyperlink{bit__banging_8c_ace95c61f334660f258cfa1ec48b46932}{data}} \mbox{[}\mbox{\hyperlink{bit__banging_8c_a6d20623550ae3618c35ef0e9cb8e9843}{D\+A\+T\+A\+\_\+\+B\+Y\+T\+ES}}\mbox{]} = \{ 0x\+A5, 0x00, 0x\+FF, 0x\+A5 \}
\begin{DoxyCompactList}\small\item\em the data \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
bit-\/banging protocol for the W\+S2812 L\+ED integrated light source 

\DoxyHorRuler


The bit-\/banging protocol is implemented in standard C and makes no use of assembly language.

\begin{DoxyNote}{Note}
For the time-\/critical transmit function the compiler optimization level has been defined to guarantee correct timing. 

The timing also depends on the clock frequency.
\end{DoxyNote}
Board\+: Starter Kit E\+F\+M32-\/\+G8\+X\+X-\/\+S\+TK Device\+: E\+F\+M32\+G890\+F128 (Gecko)

\begin{DoxyAuthor}{Author}
Hanspeter Hochreutener (\href{mailto:hhrt@zhaw.ch}{\texttt{ hhrt@zhaw.\+ch}}) 
\end{DoxyAuthor}
\begin{DoxyDate}{Date}
21.\+11.\+2017 
\end{DoxyDate}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{bit__banging_8c_a837aa058320a106868b138d6a23b5e44}\label{bit__banging_8c_a837aa058320a106868b138d6a23b5e44}} 
\index{bit\_banging.c@{bit\_banging.c}!DATA\_out@{DATA\_out}}
\index{DATA\_out@{DATA\_out}!bit\_banging.c@{bit\_banging.c}}
\doxysubsubsection{\texorpdfstring{DATA\_out()}{DATA\_out()}}
{\footnotesize\ttfamily void D\+A\+T\+A\+\_\+out (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{data\mbox{[}$\,$\mbox{]},  }\item[{uint32\+\_\+t}]{length }\end{DoxyParamCaption})}



Output the data using bit-\/banging technique. 

\DoxyHorRuler
 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em data} & to be sent \\
\hline
\mbox{\texttt{ in}}  & {\em length} & of the data \\
\hline
\end{DoxyParams}
\begin{DoxyNote}{Note}
\#pragma before and after the function is used to enable optimization ~\newline
 bus-\/access takes three clock cycles =$>$ shortest pulse = 3$\ast$1/32\+M\+Hz = 94ns ~\newline
 The correct timing is done by just repeating a command. 

See \href{https://cdn-shop.adafruit.com/datasheets/WS2812.pdf}{\texttt{ https\+://cdn-\/shop.\+adafruit.\+com/datasheets/\+W\+S2812.\+pdf}} for the timing 
\end{DoxyNote}
\mbox{\Hypertarget{bit__banging_8c_a825a38d3f87d03f011520ff66261fe74}\label{bit__banging_8c_a825a38d3f87d03f011520ff66261fe74}} 
\index{bit\_banging.c@{bit\_banging.c}!GPIO\_Init@{GPIO\_Init}}
\index{GPIO\_Init@{GPIO\_Init}!bit\_banging.c@{bit\_banging.c}}
\doxysubsubsection{\texorpdfstring{GPIO\_Init()}{GPIO\_Init()}}
{\footnotesize\ttfamily void G\+P\+I\+O\+\_\+\+Init (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Configure the G\+P\+I\+Os used for data and trigger. 

\DoxyHorRuler
 \mbox{\Hypertarget{bit__banging_8c_a6722aa896fe7c90c4e283f433ea7985d}\label{bit__banging_8c_a6722aa896fe7c90c4e283f433ea7985d}} 
\index{bit\_banging.c@{bit\_banging.c}!INIT\_XOclocks@{INIT\_XOclocks}}
\index{INIT\_XOclocks@{INIT\_XOclocks}!bit\_banging.c@{bit\_banging.c}}
\doxysubsubsection{\texorpdfstring{INIT\_XOclocks()}{INIT\_XOclocks()}}
{\footnotesize\ttfamily void I\+N\+I\+T\+\_\+\+X\+Oclocks (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}



Start crystal oscillators and use these clock sources. 

\DoxyHorRuler
 High frequency clock = 32M\+Hhz (defined by crystal on the starter kit) Low frequency clock = 32.\+768k\+Hz (defined by crystal on the starter kit) \mbox{\Hypertarget{bit__banging_8c_a840291bc02cba5474a4cb46a9b9566fe}\label{bit__banging_8c_a840291bc02cba5474a4cb46a9b9566fe}} 
\index{bit\_banging.c@{bit\_banging.c}!main@{main}}
\index{main@{main}!bit\_banging.c@{bit\_banging.c}}
\doxysubsubsection{\texorpdfstring{main()}{main()}}
{\footnotesize\ttfamily int main (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Main function. 

